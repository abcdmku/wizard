# Complex Flows

Complex flows are built from:

- Dynamic `next` resolution
- `canEnter` / `canExit` guards
- `order` for deterministic helper/progress behavior
- `prerequisites` for dependency-aware metadata

```ts
const steps = defineSteps({
  role: step({
    data: { value: 'user' as const },
    next: ({ data }) => (data.value === 'admin' ? ['admin'] : ['profile']),
  }),
  profile: step({
    data: { firstName: '' },
    next: ['review'],
    canEnter: ({ context }) => context.role === 'user',
  }),
  admin: step({
    data: { access: '' },
    next: ['review'],
    canEnter: ({ context }) => context.role === 'admin',
  }),
  review: step({
    data: { approved: false },
    next: [],
    prerequisites: ['role'],
  }),
});
```
