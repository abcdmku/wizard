# Basic Form Wizard Example

import { Callout, Tabs, Tab } from '../../components'

A complete multi-step form implementation using React with user account creation, personal information collection, address input, and confirmation step.

## Overview

This example demonstrates a complete registration wizard with three steps:
1. **Account Creation** - Email and password setup with validation
2. **Personal Information** - Name and date of birth collection
3. **Address Information** - Complete address entry with final submission

## Features

- **Multi-step Form Flow** - Three distinct steps with navigation
- **Form Validation** - Zod-like validation for each step
- **Step Progress Indicator** - Visual progress display
- **Data Persistence** - Form data maintained across steps
- **Error Handling** - Comprehensive validation and error display
- **Responsive Design** - Mobile-friendly with Tailwind CSS

## Live Demo

```bash
cd examples/basic-form-wizard
pnpm install
pnpm dev
```

Navigate to `http://localhost:5173` to see the wizard in action.

## Code Structure

### Wizard Configuration

<Callout type="warning" title="Legacy API Pattern">
This example currently uses legacy `defineSteps` and `createWizard` patterns. It should be modernized to use the `wizardWithContext` factory pattern for better type safety and developer experience.
</Callout>

```tsx
// Current implementation (legacy pattern)
const steps = defineSteps({
  account: {
    validate: validateAccount,
    data: { email: '', password: '', confirmPassword: '' },
    next: ['personal'],
    meta: { label: 'Account', iconKey: 'user' },
  },
  personal: {
    validate: validatePersonal,
    data: { firstName: '', lastName: '', dateOfBirth: '' },
    next: ['address'],
    meta: { label: 'Personal', iconKey: 'person' },
  },
  address: {
    validate: validateAddress,
    data: { street: '', city: '', state: '', zipCode: '', country: '' },
    next: [],
    meta: { label: 'Address', iconKey: 'location' },
  },
});

const wizard = createWizard({
  context: { totalSteps: 3, completedSteps: [] as string[] },
  steps,
});
```

### Modern Implementation (Recommended)

Here's how this example should be implemented using modern patterns:

```tsx
import { wizardWithContext } from '@wizard/core';

// Define context type
interface RegistrationContext {
  totalSteps: number;
  completedSteps: string[];
  registrationId: string;
}

// Create wizard with factory pattern
const { defineSteps, createWizard, step } = wizardWithContext<RegistrationContext>({
  totalSteps: 3,
  completedSteps: [],
  registrationId: ''
});

const steps = defineSteps({
  account: step({
    data: { email: '', password: '', confirmPassword: '' },
    canExit: ({ data }) => {
      if (!data?.email || !data.email.includes('@')) return false;
      if (!data?.password || data.password.length < 8) return false;
      if (data.password !== data.confirmPassword) return false;
      return true;
    },
    beforeExit: ({ context, updateContext }) => {
      updateContext(ctx => {
        ctx.completedSteps.push('account');
      });
    },
    next: ['personal']
  }),

  personal: step({
    data: { firstName: '', lastName: '', dateOfBirth: '' },
    canExit: ({ data }) => {
      return Boolean(data?.firstName && data?.lastName && data?.dateOfBirth);
    },
    beforeExit: ({ context, updateContext }) => {
      updateContext(ctx => {
        ctx.completedSteps.push('personal');
      });
    },
    next: ['address']
  }),

  address: step({
    data: { street: '', city: '', state: '', zipCode: '', country: '' },
    canExit: ({ data }) => {
      return Boolean(data?.street && data?.city && data?.state && data?.zipCode && data?.country);
    },
    beforeExit: ({ context, updateContext }) => {
      updateContext(ctx => {
        ctx.completedSteps.push('address');
        ctx.registrationId = `reg_${Date.now()}`;
      });
    },
    next: []
  })
});

const wizard = createWizard(steps);
```

## Step Components

### Account Step

The first step handles user account creation with email and password:

```tsx
function AccountStep() {
  const wizard = useWizard();
  const { next } = useWizardActions();

  const [data, setData] = useState({ email: '', password: '', confirmPassword: '' });
  const [error, setError] = useState<string>('');

  const handleNext = async () => {
    try {
      // Validate data
      if (!data.email.includes('@')) throw new Error('Invalid email');
      if (data.password.length < 8) throw new Error('Password too short');
      if (data.password !== data.confirmPassword) throw new Error('Passwords do not match');

      // Use fluent API for data updates
      wizard
        .getCurrentStep()
        .setData(data)
        .markLoading();

      await next();
    } catch (err) {
      setError(err instanceof Error ? err.message : 'Validation failed');
    }
  };

  return (
    <div className="space-y-4">
      <h2 className="text-2xl font-bold">Create Account</h2>

      <input
        type="email"
        value={data.email}
        onChange={(e) => setData({ ...data, email: e.target.value })}
        placeholder="you@example.com"
        className="w-full px-3 py-2 border border-gray-300 rounded-md"
      />

      <input
        type="password"
        value={data.password}
        onChange={(e) => setData({ ...data, password: e.target.value })}
        placeholder="Min 8 characters"
        className="w-full px-3 py-2 border border-gray-300 rounded-md"
      />

      <input
        type="password"
        value={data.confirmPassword}
        onChange={(e) => setData({ ...data, confirmPassword: e.target.value })}
        placeholder="Re-enter password"
        className="w-full px-3 py-2 border border-gray-300 rounded-md"
      />

      {error && (
        <div className="p-3 bg-red-50 border border-red-200 text-red-600 rounded-md">
          {error}
        </div>
      )}

      <button
        onClick={handleNext}
        className="w-full py-2 px-4 bg-blue-600 text-white rounded-md hover:bg-blue-700"
      >
        Next
      </button>
    </div>
  );
}
```

### Step Progress Indicator

A visual indicator showing current progress:

```tsx
function StepIndicator() {
  const currentStep = useWizardStep();
  const wizard = useWizard();

  const steps = ['account', 'personal', 'address'];
  const stepLabels = ['Account', 'Personal', 'Address'];
  const progress = wizard.helpers.progress(); // Get completion percentage

  return (
    <div className="mb-6">
      {/* Progress bar */}
      <div className="w-full bg-gray-200 rounded-full h-2 mb-4">
        <div
          className="bg-blue-600 h-2 rounded-full transition-all duration-300"
          style={{ width: `${progress}%` }}
        />
      </div>

      {/* Step indicators */}
      <div className="flex justify-between">
        {steps.map((step, index) => (
          <div key={step} className="flex items-center">
            <div className={`
              w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium
              ${currentStep === step ? 'bg-blue-600 text-white' :
                steps.indexOf(currentStep) > index ? 'bg-green-600 text-white' :
                'bg-gray-200 text-gray-600'}
            `}>
              {steps.indexOf(currentStep) > index ? 'âœ“' : index + 1}
            </div>
            <span className="ml-2 text-sm font-medium text-gray-600">
              {stepLabels[index]}
            </span>
          </div>
        ))}
      </div>
    </div>
  );
}
```

## Key Patterns Demonstrated

### 1. Form State Management

```tsx
// Local component state for immediate UI feedback
const [data, setData] = useState(initialData);

// Wizard state for persistence across steps
const handleSave = () => {
  wizard.getCurrentStep().setData(data);
};
```

### 2. Validation Patterns

```tsx
// Immediate validation on input
const validateEmail = (email: string) => {
  return email.includes('@') && email.length > 5;
};

// Step-level validation before navigation
const canProceed = () => {
  return validateEmail(data.email) &&
         data.password.length >= 8 &&
         data.password === data.confirmPassword;
};
```

### 3. Error Handling

```tsx
const [error, setError] = useState<string>('');

const handleSubmit = async () => {
  try {
    await wizard.getCurrentStep().setData(data).next();
    setError('');
  } catch (err) {
    setError(err instanceof Error ? err.message : 'Something went wrong');
  }
};
```

## Styling with Tailwind CSS

The example uses Tailwind CSS for styling:

```css
/* Key classes used */
.space-y-4      /* Vertical spacing between elements */
.w-full         /* Full width */
.px-3 .py-2     /* Padding */
.border         /* Border styling */
.rounded-md     /* Rounded corners */
.bg-blue-600    /* Background colors */
.text-white     /* Text colors */
.hover:bg-blue-700  /* Hover states */
.focus:ring-2   /* Focus states */
```

## Running the Example

1. **Clone the repository:**
   ```bash
   git clone https://github.com/your-org/wizardopus.git
   cd wizardopus
   ```

2. **Install dependencies:**
   ```bash
   pnpm install
   ```

3. **Navigate to example:**
   ```bash
   cd examples/basic-form-wizard
   ```

4. **Start development server:**
   ```bash
   pnpm dev
   ```

5. **Open in browser:**
   ```
   http://localhost:5173
   ```

## Modernization Roadmap

To bring this example up to current standards:

1. **Factory Pattern**: Replace `defineSteps`/`createWizard` with `wizardWithContext`
2. **Step Helpers**: Use `step()`, `stepWithValidation()` helpers
3. **Fluent API**: Leverage method chaining for cleaner data operations
4. **TypeScript**: Add comprehensive type definitions
5. **Validation**: Integrate with Zod or similar schema validation
6. **Testing**: Add unit and integration tests

## Related Examples

- [React Router Integration](/examples/react-router-wizard) - URL synchronization
- [Zod Validation](/examples/zod-validation) - Advanced validation patterns
- [Advanced Branching](/examples/advanced-branching) - Complex conditional flows

This example provides a solid foundation for understanding multi-step form implementation with Wziard, though modernization to current API patterns is recommended for new projects.