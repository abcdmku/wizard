# Defining Flows

Use `createWizardFactory` + `defineSteps` + `step`.

```ts
import { createWizardFactory } from '@wizard/core';

type Context = { role: 'user' | 'admin' };

const factory = createWizardFactory<Context>();
const { defineSteps, step } = factory;

const steps = defineSteps({
  role: step({
    data: { role: 'user' as const },
    next: ({ data }) => (data.role === 'admin' ? ['admin'] : ['profile']),
  }),
  profile: step({
    data: { firstName: '', lastName: '' },
    next: ['done'],
    canEnter: ({ context }) => context.role === 'user',
  }),
  admin: step({
    data: { accessKey: '' },
    next: ['done'],
    canEnter: ({ context }) => context.role === 'admin',
  }),
  done: step({
    data: { confirmed: false },
    next: [],
  }),
});
```

Create the wizard:

```ts
const wizard = factory.createWizard(steps, {
  context: { role: 'user' },
  order: ['role', 'profile', 'admin', 'done'],
});
```

## Authoring rules

- Prefer `step()` for per-step data inference.
- Keep `next` explicit (`['step']`), dynamic (`(args) => ...`), or `'any'`.
- Put guard logic in `canEnter` / `canExit`.
- Put data validation in `validate`.

## Step generics

Factory step generics are:

- `step<Data>()` for data typing only
- `step<Data, StepError>()` to override per-step error type

Standalone helper `step` has a different order:

- `step<Data, Context, StepError>()`
