# Getting Started

import { Callout, Steps, Step, Tabs, Tab } from '../components'

Welcome to Wizard! This guide will help you get up and running with type-safe multi-step wizards in your TypeScript application.

## Installation

<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab label="npm">
    ```bash
    npm install @wizard/core
    ```
  </Tab>
  <Tab label="pnpm">
    ```bash
    pnpm add @wizard/core
    ```
  </Tab>
  <Tab label="yarn">
    ```bash
    yarn add @wizard/core
    ```
  </Tab>
</Tabs>

For React applications, also install the React adapter:

<Tabs items={['npm', 'pnpm', 'yarn']}>
  <Tab label="npm">
    ```bash
    npm install @wizard/react
    ```
  </Tab>
  <Tab label="pnpm">
    ```bash
    pnpm add @wizard/react
    ```
  </Tab>
  <Tab label="yarn">
    ```bash
    yarn add @wizard/react
    ```
  </Tab>
</Tabs>

## Basic Usage

<Steps>
  <Step title="Define your step data types">
    ```typescript
    interface UserData {
      name: string;
      email: string;
    }

    interface AddressData {
      street: string;
      city: string;
      country: string;
    }

    interface PaymentData {
      cardNumber: string;
      expiryDate: string;
    }
    ```
  </Step>

  <Step title="Define shared context">
    ```typescript
    interface CheckoutContext {
      totalAmount: number;
      currency: string;
      items: Array<{ id: string; quantity: number }>;
    }
    ```
  </Step>

  <Step title="Create your wizard configuration">
    ```typescript
    import { createWizard, type WizardConfig } from '@wizard/core';

    type Steps = 'user' | 'address' | 'payment' | 'confirm';

    type StepData = {
      user: UserData;
      address: AddressData;
      payment: PaymentData;
      confirm: { orderId: string };
    };

    const config: WizardConfig<CheckoutContext, Steps, StepData> = {
      initialStep: 'user',
      initialContext: {
        totalAmount: 0,
        currency: 'USD',
        items: []
      },

      // Optional: Define prerequisites for automatic ordering
      prerequisites: {
        address: ['user'],
        payment: ['address'],
        confirm: ['payment']
      },

      // Optional: Add progress weights
      weights: {
        user: 2,
        address: 3,
        payment: 4,
        confirm: 1
      },

      steps: {
        user: {
          next: ['address'],
          validate: (data: unknown): asserts data is UserData => {
            if (!data || typeof data !== 'object') {
              throw new Error('Invalid data');
            }
            const d = data as any;
            if (!d.email?.includes('@')) {
              throw new Error('Invalid email');
            }
          }
        },
        address: {
          next: ['payment'],
          prev: ['user']
        },
        payment: {
          next: ['confirm'],
          canEnter: async ({ ctx }) => {
            // Check if user is authenticated
            return ctx.totalAmount > 0;
          }
        },
        confirm: {
          next: [],
          load: async ({ setStepData }) => {
            // Generate order ID
            const orderId = Math.random().toString(36).substring(7);
            setStepData({ orderId });
          }
        }
      }
    };

    const checkoutWizard = createWizard(config);
    ```
  </Step>

  <Step title="Use the wizard in your application">
    ```typescript
    // Get current step and context
    const current = checkoutWizard.getCurrent();
    console.log('Current step:', current.step);
    console.log('Current data:', current.data);

    // Update step data
    checkoutWizard.setStepData('user', {
      name: 'John Doe',
      email: 'john@example.com'
    });

    // Navigate between steps
    await checkoutWizard.next({ data: formData });
    await checkoutWizard.back();
    await checkoutWizard.goTo('payment');

    // Update shared context
    checkoutWizard.updateContext(ctx => {
      ctx.totalAmount = 99.99;
    });

    // Use helpers
    const progress = checkoutWizard.helpers.progress();
    console.log(`Progress: ${progress.percent}%`);

    const canGoNext = checkoutWizard.helpers.canGoNext();
    const isComplete = checkoutWizard.helpers.isComplete();

    // Subscribe to changes
    const unsubscribe = checkoutWizard.subscribe((state) => {
      console.log('Current step:', state.step);
      console.log('Is loading:', state.isLoading);
    });
    ```
  </Step>
</Steps>

## React Integration

For React applications, use the provided hooks and provider:

```tsx
import { WizardProvider, useWizard, useWizardState, useWizardActions } from '@wizard/react';

function App() {
  return (
    <WizardProvider wizard={checkoutWizard}>
      <WizardSteps />
    </WizardProvider>
  );
}

function WizardSteps() {
  const wizard = useWizard();
  const state = useWizardState();
  const { next, back, goTo } = useWizardActions();

  // Use helpers for UI state
  const progress = wizard.helpers.progress();
  const canGoNext = wizard.helpers.canGoNext();
  const currentStatus = wizard.helpers.stepStatus(state.step);

  return (
    <div>
      <div className="progress-bar">
        <div style={{ width: `${progress.percent}%` }} />
        <span>{progress.label}</span>
      </div>

      <h2>Step: {state.step}</h2>
      <p>Status: {currentStatus}</p>

      {/* Render current step component */}
      {state.step === 'user' && <UserStep />}
      {state.step === 'address' && <AddressStep />}

      <button onClick={back} disabled={!wizard.helpers.canGoBack()}>
        Previous
      </button>
      <button onClick={() => next()} disabled={!canGoNext}>
        Next
      </button>
    </div>
  );
}
```

<Callout type="info" title="Type Safety">
  All wizard operations are fully type-safe. TypeScript will catch invalid step names, data shapes, and context mutations at compile time.
</Callout>

## Next Steps

- Explore [Core Concepts](/concepts) to understand the architecture
- Check out [Recipes](/recipes) for common patterns
- Browse [Examples](/examples) for complete implementations
- Read the [API Reference](/api-reference) for detailed documentation